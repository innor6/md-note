# 13 有向图和网络

无向边：{a,b}

有向边：(a,b)，也叫弧。

一般有向图中，顶点度入度之和等于出度之和，且都等于图中弧的个数。



定向：给无向图的边标上方向。

基础一般图：把有向图的弧去掉方向。

竞赛图：完全图Kn的定向。它相当于n位选手互相竞赛，记录胜败。



连通：弱连通，指有向图的基础一般图是连通的。

强连通：每对不同顶点a和b，都存在a到b和b到a的有向途径。



有向欧拉闭迹：每个顶点的入度 = 出度

有向欧拉开迹：s的出度比入度大1，t的入度比出度大1，其他顶点入度 = 出度。

有向哈密顿圈：有向强连通图中，每个顶点的 入度 + 出度 ≥ n。

每个竞赛图中都存在哈密顿路径，即可以找出一个选手pi的排列，使得p1胜p2，p2胜p3，...。



无向连通图有强连通定向，当且仅当G中没有桥（只有圈）

强连通定向算法：

1. 因为没有桥，所以每条边都在圈中
2. 定向出一个有向圈，则圈中顶点互相可达，构成强连通分量U
3. U中连出一条边，找含这条边的有向圈，将圈合并到U中。



### 交易问题——核心分配

分配：n个交易商t1, t2, t3, ... ，每人带一件商品带到市场上来交换，使得n件物品在n个交易商之间重新分配。

假设：每个交易商对这n件物品按偏爱顺序排列，偏爱程度不能有并列。

核心分配：不存在少于n个交易商的子集，使得它们的小团体私下交易时，每个人都能获得比核心分配中排位还要高的商品。（在小团体交易中，既然有至少一个人会获得比集体交易排位低的商品，则那个人肯定会选择去集体交易）

**有向圈**

引理：如果有向图中每个顶点的出度至少是1，则D中存在有向圈。（这个有向圈不一定包含全部顶点）

推论：X是n个元素集合，存在一对一映射 X → X，把这个映射画成有向图D中的弧，则D的弧可以被划分为有向圈，且每个顶点恰好属于一个有向圈。

定理：每一个交易问题都存在核心分配。

算法：

1. 设交易商的集合为 V = {t1, t2, ..., tn}
2. 画出偏爱有向图D1，图中ti到tj存在弧(ti, tj)，当且仅当ti在所有商品中最喜欢tj的商品。（即D1中每个交易商指向第一想要的商品）
3. 根据引理，D1中必然存在一个有向圈，令这个圈中的交易商互相交换商品。
4. 对剩下的交易商画出偏爱有向图D2，图中的弧表示交易商第二喜欢的商品，则又得到一个有向圈，令圈中的交易商交易。
5. 重复步骤4。



### 网络

网络是指定了两个顶点源s和目标t的有向图，每条弧有非负的权c(α)，叫做弧的容量。

流：f，为网络中每一条弧赋一个实数f(α)。

- 0 ≤ f(α) ≤ c(α)。
- 对于不是s或t的其他顶点x，进入x的流量等于流出x的流量。

流的值：val(f)，净流量，等于：

- 流出s - 流入s的流量
- 流入t - 流出t 的流量
- 流出U - 流入U的流量，U是包含s但不包含t的顶点集合。

割集：C，从s到t的每条路径中至少包含一条弧，C的容量cap(C)是C中弧的容量之和。

最小割集：容量最小的割集。

极小割集：删除C中任意一条弧得到的集合都不再是割集。



引理：U是所有这样的顶点x的集合：存在从s到x的路径，且x不是t。则以U为起始顶点的弧的集合\vec{U}是该网络的极小割集。

双最定理：网络N的最大流的值等于最小割集的容量，val(f) = cap(C)。

**基本流算法（Ford-Fulkson）**：

1. 找一条可增载路径：从s出发，令 U = {s}，若存在一个弧使得它一个端点在U中，另一个端点不在U中，且它是一条还能继续增大流量的正向弧，或是还能继续减少流量的反向弧，则将端点加入到U中。直到没有这样的弧。
2. 如果t在U中，则存在可增载路径，正向弧扩容，反向弧缩小相同容量。
3. 如果t不在U中，则\vec{U}是一个最小割集，f是最大流。

手算指南：

从终点t开始找可增载路径，如果看到一条正向弧流量已满，或反向弧流量已空，就可以不用考虑这个方向了。



应用：

设s和t是有向图G中的不同顶点，则s到t的逐对弧不相交的路径的最多数目 = 弧容量为1的网络的最小割集。