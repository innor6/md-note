# history

Paul Baran的分布式通信设计：

- 动态路由，分组交换转发报文，分布式系统。
- 无连接：简单、灵活、可扩展性、健壮。
- 场景限制：适用于低负载、短消息的。
- 实现：Internet

面向连接（电话系统）：每个部件通过冗余实现高可靠性，适合高负载的场景。



# chapter 1

baran 3点:
分组交换
动态路由
出错后由客户处理

28 30 31 34
网络 -> 抽象成 图（节点和链路）
网络的表示
网络云
服务提供商
接入

4节: 网络组成、网络结构、二层交换机、以太网技术

39 40 41 42 44 45
冲突域：同一导线上存在冲突，只能互斥使用，网桥、交换机可以分割冲突域；
广播域：同一网络中可以进行广播，路由器分割广播域。
网桥/交换机组网：
局域网是碰撞域，一次只能一台设备发送信息，局域网中其他设备都能收到信息（也是广播域）；
将设备与网桥的每个端口分别连接，一个端口对应了一个碰撞域，如果一台设备独占一个端口，则没有碰撞；
可以增加总带宽，n个端口就是n倍带宽。
自学习：根据收到帧的端口，确定主机的位置，从而自动生成路由表

  交换机转发帧：
收到帧，根据目的地址，查找mac地址（CAM）表：
目的地址在帧发来的一端：丢弃
mac表中查到目的地址对应端口：转发到对应端口
mac表中查不到：转发到所有端口，除了发来帧的端口
自学习：每次收到新的源mac的帧，都添加“mac-端口”条目到mac表
3层交换机：能处理ip地址，使用ARP根据目标ip，广播查询目标mac

3.3
交换机端口扩展了信道资源，一个端口一个广播域。
vlan：利用多个交换机即软件，分割广播域为多个虚拟局域网

区别？
有线通讯：带宽高、出错率低、频谱复用方便，但不支持移动应用
无线通讯：带宽低、出错率高、（近距离）频谱复用困难，但支持移动应用

【以太网原理】
若干设备共享总线（信道），广播，总线独占使用（类似进程调度中的cpu分配）
CSMA/CD（载波监听，多路访问，碰撞检测）
\- 发前先听（看能否使用临界资源）
\- 基于最小发送帧长的边发边听（可能发生碰撞的时间最长为一个RTT，即发到对端时对端也开始发送，导致碰撞，因此为了能检测到碰撞发生，至少要听一个RTT的时间，这也决定了报文的最小帧长）
\- 发现冲突后采用二进制指数后退（降低负载量）
\- 立即停发
\- 转发强化
局限性：适合网络负载较低的场景，因而不适合千兆网（最小帧长：RTT*带宽）。

OSI
分层模型的概念
服务
	下层为上层提供服务
	有连接：提供可靠传输、有序的传输，需要预置网络资源
	无连接：只依据局部的、不完整的信息就可以完成传输，只适合低负载的网络，不能实现可靠、有序，不预置网络资源
2.接口
3.封装
致命缺陷：分层结构，上层协议依赖于下层协议，带来性能问题，只适合在网络负载较低的情形。不能全局优化。低层的问题交给高层去优化解决，不可能，只在网络低负载时可行。

数据链路层：
差错控制：
纠错码，超时计时器，帧序号
流量控制：

网络层：分组转发
传输层：进程到进程的报文交付



LAN
最小帧长：
源于碰撞检测机制，最坏情况下发送的对端才发送碰撞，碰撞传回，总共经过2倍的转播时间：
标准以太网（10Mbps）最大传播时间为25.6us，最小帧长25.6us * 2 * 10M = 512bit = 64B
首部+CRC共18B，因此payload至少46B，最大1500B，超过会分开发送。
（数据传输率越大，网线的允许长度越短；1000M通过交换机实现全双工，不再用CSMA/CD）

WLAN
CSMA/CA碰撞避免：RTS，CTS握手，数据，ACK
握手时，仅收到CTS帧的节点说明有隐藏节点
帧格式复杂，因为覆盖了分布式信道，以及集中式信道。
隐藏站，暴露站。

网络层
chap 4
分组交换：对于同一来源同一目的的分组，虽然网络层提供了将不同分组发到不同路由（动态路由）的能力，但通常路由表不会经常的变化，因此路由器一般会为这些报文选择同一条（最优的）路由。无连接的分组交换：（适合网络负载低时）
优点：独立的处理每个一分组，在分组的逐跳转发过程中，只需要知道局部的网络信息，就可以进行路由选择，是局部优化的路由选择过程；不需要资源的预置。
缺点：不能进行可靠传输、不能有序传输
面向连接的分组交换：（适合网络负载高时）
优点：可靠传输，有序传输，资源预置
不足：需要知道全局的网络状态信息（可以分治的获取）  



chap 5

判断ip地址类别：

第一位为0：A类（0-127）

第二位为0：B类（127-191）

第三位为0：C类（192-223）

第四位为0：D类（224-239，多播，32位都是网络号）

第五位为0：E类（240-255，保留，32位都是网络号）



子网划分：一个交换机由于端口有限，无法连接一个局域网内所有主机——将一个网络划分为多个子网，每个子网一个交换机。
超网：将多个网络合并，减少路由表表项。但合并的网络数量必须为2的倍数。
无分类编址：将ip分为网络号与主机号，斜线/CIDR记法。如果不指定网络掩码，则同一个ip可以对应多个网络地址块。
NAT：网络地址转换，内网主机出网共用同一个公共IP。适合无连接的互联。  





